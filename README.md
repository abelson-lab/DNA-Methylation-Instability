# DNA-Methylation-Instability
This repository contains code to reproduce all analyses and figures from \<citation\>.

### Dependencies
#### Python:
- pandas
- scipy
- matplotlib
- pyreadr
- sksurv
- lifelines
#### R
- 

### Running the scripts
After setting up your environment and cloning the repository, execute the scripts from the command line or an IDE of your choice. Auxiliary data files necessary for some of the analyses are stored in `data/`. Larger files, such as β-value matrices, can be downloaded from Zenodo \<URL\> and placed in the `data/` directory. Required files are listed at the top of each script.

Source data files for the figures will be created in `plots/inputs`. All figures can be generated by running `plot_figures.R`, which saves them to `plots/figures`. Some figures are generated directly from the Python scripts.

### Descriptions
`01_determne_ESLs.py`: Determine the most stable (i.e., lowest variance) CpG sites from the discovery cohort and apply filtering based on β-values in purified blood cell types.
- Output: source data for Fig. 1a,b, Supplementary Fig. 2

`02_ESLs_in_human_tissues.py`: Examine ESL methylation levels in various human tissues from the WGBS-derived methylation cell atlas by Loyfer et al.
- Output: source data for Fig. 1c

`03_ESLs_in_cancers.py`: Calculate average β-values at ESLs in various cancer and control cohorts.
- Output: source data for Fig. 2, Extended Data Fig. 1, Supplementary Fig. 3

`04_pan-cancer_beta_values.py`: Create the matrix of ESL β-values across the pan-blood cancer cohort.

`05_pan-cancer_recurrence_vs_beta.py`: Examine the correlation between recurrence and β-values in the pan-cancer cohort and in specific cancer types.
- Output: Supplementary Fig. 5

`06_lymphoid_myeloid_enriched_ESLs.py`: Determine lymphoid-enriched and myeloid-enriched ESLs, subsequently used for scATAC-seq analysis.
- Output: Supplementary Fig. 4

`09_clustering_Dx_Rel_pairs.py`: # Cluster diagnosis and relapse pairs from AML, BCP-ALL, and CLL based on the most destabilized ESLs found at relapse.
- Output: Fig. 4a,b,c, Extended Data Fig. 3, Supplementary Fig. 6

`10_longitudinal_DMI.py`: Examine DMI levels in AML patients who were sampled at different times throughout their disease (diagnosis, remission, relapse).
- Output: Fig. 4d

`11_mutations_and_DMI.py`: Examine DMI levels and mutation VAFs in AML patients who were sampled at diagnosis and post-induction therapy.
- Output: Fig. 4e, Extended Data Fig. 4

`12_age_correlation.py`: Calculate correlation between DMI and age in cohorts of healthy individuals.
- Output: Fig. 5a, Extended Data Fig. 5

`13_cardiovascular_patients_survival.py`: Conduct Kaplan-Meier and Cox proportional hazards regression analyses on the Framingham Heart Study cohort and the cardiogenic shock cohort.
- Output: Fig. 5b-h, Supplementary Fig. 7
